var Rum=new function(){var asyncParam="",validationTimeout=10,validationReady=!0;this.defaultFlashHandler=function(e){alert(e)},this.defaultAjaxStartHandler=function(){},this.defaultAjaxCompletionHandler=function(){},this.defaultTimeoutHandler=function(){alert("The Web server request has timed out!")},this.defaultErrorHandler=function(){alert("The Web server encountered an unexpected condition that prevented it from fulfilling the request!")},this.defaultTimeout=3e4,this.init=function(e,t){asyncParam=e,validationTimeout=t},this.id=function(e){return document.getElementById(e)},this.flash=function(e,t){this.defaultFlashHandler(e,t)},this.forward=function(e){location.href=e},this.getParams=function(e){var t="",n=e.getElementsByTagName("input"),a=e.getElementsByTagName("select"),i=e.getElementsByTagName("textarea");for(x=0;x<n.length;x++)"button"!==n[x].getAttribute("type")&&"submit"!==n[x].getAttribute("type")&&"image"!==n[x].getAttribute("type")&&("checkbox"===n[x].getAttribute("type")?n[x].checked&&(t&&(t+="&"),t=t+n[x].getAttribute("name")+"="+n[x].value):(t&&(t+="&"),t=t+n[x].getAttribute("name")+"="+n[x].value));for(x=0;x<a.length;x++)t&&(t+="&"),t=t+a[x].getAttribute("name")+"="+a[x].value;for(x=0;x<i.length;x++)t&&(t+="&"),t=t+i[x].getAttribute("name")+"="+i[x].value;return t},this.sendSync=function(e,t,n){if(n||(n="GET"),t||(t=""),"GET"===n.toUpperCase()&&t)e=e.indexOf("?")>-1?e+"&"+t:e+"?"+t,t="",location.href=e;else{t=t.split("&");var a=document.createElement("form");a.action=e,a.method="POST",a.style.display="none";for(var i=0;i<t.length;i++){param=t[i].split("=");var o=document.createElement("input");o.setAttribute("name",param[0]),o.setAttribute("value",param[1]),a.appendChild(o)}document.body.appendChild(a),a.submit()}},this.submit=function(e,t,n){var a={};return t||(t=this.defaultAjaxStartHandler),n||(n=this.defaultAjaxCompletionHandler),createFrame(e,n,a),t(a),!0},this.sendAsync=function(e,t,n,a,i){var o;i||(i=this.defaultTimeout),o||(o=this.defaultTimeoutHandler);var r=this.createXMLHttpRequest();sendHTTPRequest(r,e,t,n,a,i,o)},this.evalAsync=function(e,t,n,i,o,r){var l,s,d={};i||(i=this.defaultAjaxStartHandler),o||(o=this.defaultAjaxCompletionHandler),r||(r=this.defaultTimeout),l||(l=this.defaultErrorHandler),s||(s=this.defaultTimeoutHandler),t.split("&").forEach(function(e){a=e.split("="),d[a[0]]=a[1]});var u=this.createXMLHttpRequest(),c=function(){evalHttpResponse(u,o,l,d)};sendHTTPRequest(u,e,t,n,c,r,s),i(d)},this.documentLoaded=function(e,t){var n=document.getElementById(t)?document.getElementById(t):"",a=null;if(n.contentDocument)a=n.contentDocument;else{if(!n.contentWindow)return;a=n.contentWindow.document}"about:blank"!==a.location.href&&n.completeCallback(e,a.body.textContent)},this.reset=function(){validationReady=!1,window.setTimeout("setValidationReady()",validationTimeout)},this.isReady=function(e){return hasText(this.id(e))?validationReady:!1},this.createXMLHttpRequest=function(){var e;if(window.XMLHttpRequest)e=new XMLHttpRequest,e.overrideMimeType&&e.overrideMimeType("text/html");else if(window.ActiveXObject)try{e=new ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{e=new ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}if(!e)throw"Cannot create XMLHTTP instance";return e},this.convertValuesFromListBox=function(e){for(var t="",n=0;n<e.options.length;n++)e.options[n].selected&&(t.length>0&&(t+="&"),t+=e.getAttribute("name")+"[]="+e.options[n].value);return t},setValidationReady=function(){validationReady=!0},sendHTTPRequest=function(e,t,n,a,i,o,r){a||(a="GET"),n?n+="&"+asyncParam+"=1":n="?"+asyncParam+"=1","GET"===a.toUpperCase()&&n&&(t=t.indexOf("?")>-1?t+"&"+n:t+"?"+n,n=""),null!==i&&(e.onreadystatechange=i),e.open(a,t,!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),o&&(e.timeout=o,e.ontimeout=r),e.send(n)},evalHttpResponse=function(http_request,completionHandler,errorHandler,eventArgs){eval(getHttpResponse(http_request,completionHandler,errorHandler,eventArgs))},getHttpResponse=function(e,t,n,a){if(e&&4===e.readyState){if(200===e.status)return response=e.responseText,t(a),response;n(e.status),console.log("Error Status Code:"+e.status)}},evalFormResponse=function(formElement,response){var eventArgs={},completionHandler=Rum.defaultAjaxCompletionHandler;eval(response),completionHandler(eventArgs),formElement.removeChild(Rum.id(formElement.getAttribute("id")+"__async")),formElement.setAttribute("target","")},createFrame=function(e){var t=this.evalFormResponse,n="f"+Math.floor(99999*Math.random()),a=document.createElement("DIV"),i=document.getElementById(e.getAttribute("id")+"__async_postback");i&&i.parentNode.removeChild(i),a.id=e.getAttribute("id")+"__async_postback",a.innerHTML='<iframe style="display:none" src="about:blank" id="'+n+'" name="'+n+'" onload="Rum.documentLoaded(Rum.id(\''+e.getAttribute("id")+"'), '"+n+"'); return true;\"></iframe>",document.body.appendChild(a);var o=document.getElementById(n);o.completeCallback=t;var r=document.createElement("input");r.setAttribute("type","hidden"),r.setAttribute("name",asyncParam),r.setAttribute("value","1"),r.setAttribute("id",e.getAttribute("id")+"__async"),e.appendChild(r),e.setAttribute("target",n)},setText=function(e,t){if(e){if(e.hasChildNodes())for(;e.childNodes.length>=1;)e.removeChild(e.firstChild);var n=document.createElement("span");t.length>0?(n.appendChild(document.createTextNode(t)),e.style.display="block"):(n.appendChild(document.createTextNode("")),e.style.display="none"),e.appendChild(n)}},hasText=function(e){return e&&e.hasChildNodes()&&e.childNodes.length>=1&&e.childNodes[0].textContent.length>0?!0:null},addListener=function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n},setOpacity=function(e,t){0===t?e.parentNode.removeChild(e):(e.style.opacity=t,e.style.MozOpacity=t,e.style.KhtmlOpacity=t,e.style.filter="alpha(opacity="+100*t+");")},createTimeoutHandler=function(e,t){return function(){setOpacity(e,t)}},fadeOut=function(e,t){var n=20;t||(t=1e3);for(var a=1;n>=a;a++)setTimeout(createTimeoutHandler(e,1-a/n),a/n*t)},this.gridViewSelectAll=function(e){for(var t=document.getElementById(e),n=document.getElementById(e+"__selectall"),a=t.getElementsByTagName("input"),i=0;i<a.length;i++)a[i].className===e+"__checkbox"&&(a[i].checked=n.checked)},this.gridViewUnSelectAll=function(e){for(var t=document.getElementById(e).getElementsByTagName("tr"),n=0;n<t.length;n++)"selected row"===t[n].className&&(t[n].className="row"),"selected row_alt"===t[n].className&&(t[n].className="row_alt")}};